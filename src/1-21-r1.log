üöÄ Starting Grid Search: 7 Experiments Queued.
üìÇ Root Output: /mnt/g/GitHub/VAE_ca_proj/src/AutoSearch_Results

############################################################
‚ñ∂Ô∏è  [1/7] Running Experiment: Exp1_Baseline
‚ÑπÔ∏è  Description: „ÄêÂü∫ÂáÜÁ∫ø„ÄëÂêÑÈ°πÂèÇÊï∞‰∏≠Â∫∏ÔºåÁî®‰∫éÂØπÊØîÂÖ∂‰ªñÂÆûÈ™åÁöÑÊèêÂçáÂπÖÂ∫¶„ÄÇ
############################################################
[11:18:11][INFO] ==================================================
[11:18:11][INFO] üöÄ Initializing Experiment
[11:18:11][INFO] üìÇ Save Dir  : AutoSearch_Results/Exp1_Baseline/checkpoints
[11:18:11][INFO] Device      : cuda
[11:18:11][INFO] Batch Size  : 64
[11:18:11][INFO] Resolution  : 256x256
[11:18:11][INFO] ‚ö° LR: 0.0001 | Weight: 5.0
[11:18:11][INFO] üé≤ Label Drop Prob: 0.15 (Null ID: 2)
[11:18:11][INFO] ==================================================
[11:18:11][INFO] [Init] Loading VAE (stabilityai/sd-vae-ft-mse)...
[11:18:13][INFO] [Init] Loading Training Dataset...
üîç [Dataset] Êâ´Êèè Latent Êï∞ÊçÆ: /mnt/f/monet2photo/monet2photo/train_latents
   üìÇ Á±ªÂà´ 0 (trainA): 1072 ‰∏™Êñá‰ª∂
   üìÇ Á±ªÂà´ 1 (trainB): 6287 ‰∏™Êñá‰ª∂
[11:18:13][INFO] [Init] Dataset Ready. Total Latents: 7359
[11:18:13][INFO] ==================================================
[11:18:13][INFO] >>> Starting Stage 1: LSFM Training
[11:18:13][INFO] ==================================================
[11:18:13][INFO] [Model] Compiling network with torch.compile (max-autotune)...
[11:18:14][INFO] üìÇ Loading checkpoint: AutoSearch_Results/Exp1_Baseline/checkpoints/stage1_epoch73.pt
[11:18:15][INFO] ‚úÖ Optimizer state restored
[11:18:15][INFO] ‚úÖ Scheduler state restored
[11:18:15][INFO] ‚úÖ Resumed from epoch 73, best_loss=0.050329
[11:20:52][INFO] [S1] Epoch 074 | Avg Loss: 0.048384 | Best: 0.048384 | LR: 1.78e-05 | Time: 156.6s
[11:20:53][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch71.pt
[11:20:53][INFO] [Inference] Starting Epoch 74 | Steps: 4
[11:21:22][INFO] [Inference] Error processing 00010.jpg: Error: accessing tensor output of CUDAGraphs that has been overwritten by a subsequent run. Stack trace: File "/mnt/g/GitHub/VAE_ca_proj/src/SAFlow.py", line 242, in forward
    v = self.final(x). To prevent overwriting, clone the tensor outside of torch.compile() or call torch.compiler.cudagraph_mark_step_begin() before each model invocation.
[11:21:24][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep74
[11:21:56][INFO] [S1] Epoch 075 | Avg Loss: 0.056463 | Best: 0.048384 | LR: 1.66e-05 | Time: 32.4s
[11:21:57][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch72.pt
[11:21:57][INFO] [Inference] Starting Epoch 75 | Steps: 4
[11:21:58][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep75
[11:22:31][INFO] [S1] Epoch 076 | Avg Loss: 0.048376 | Best: 0.048376 | LR: 1.55e-05 | Time: 32.6s
[11:22:32][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch73.pt
[11:22:32][INFO] [Inference] Starting Epoch 76 | Steps: 4
[11:22:33][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep76
[11:23:06][INFO] [S1] Epoch 077 | Avg Loss: 0.051132 | Best: 0.048376 | LR: 1.44e-05 | Time: 32.9s
[11:23:07][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch74.pt
[11:23:07][INFO] [Inference] Starting Epoch 77 | Steps: 4
[11:23:07][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep77
[11:23:39][INFO] [S1] Epoch 078 | Avg Loss: 0.051579 | Best: 0.048376 | LR: 1.34e-05 | Time: 32.1s
[11:23:40][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch75.pt
[11:23:40][INFO] [Inference] Starting Epoch 78 | Steps: 4
[11:23:41][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep78
[11:24:13][INFO] [S1] Epoch 079 | Avg Loss: 0.050073 | Best: 0.048376 | LR: 1.24e-05 | Time: 32.2s
[11:24:14][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch76.pt
[11:24:14][INFO] [Inference] Starting Epoch 79 | Steps: 4
[11:24:15][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep79
[11:24:48][INFO] [S1] Epoch 080 | Avg Loss: 0.044191 | Best: 0.044191 | LR: 1.14e-05 | Time: 32.5s
[11:24:49][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch77.pt
[11:24:49][INFO] [Inference] Starting Epoch 80 | Steps: 4
[11:24:49][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep80
[11:25:22][INFO] [S1] Epoch 081 | Avg Loss: 0.050836 | Best: 0.044191 | LR: 1.05e-05 | Time: 32.1s
[11:25:22][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch78.pt
[11:25:23][INFO] [Inference] Starting Epoch 81 | Steps: 4
[11:25:23][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep81
[11:25:55][INFO] [S1] Epoch 082 | Avg Loss: 0.048106 | Best: 0.044191 | LR: 9.56e-06 | Time: 32.1s
[11:25:56][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch79.pt
[11:25:56][INFO] [Inference] Starting Epoch 82 | Steps: 4
[11:25:57][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep82
[11:26:30][INFO] [S1] Epoch 083 | Avg Loss: 0.049154 | Best: 0.044191 | LR: 8.71e-06 | Time: 32.3s
[11:26:31][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch80.pt
[11:26:31][INFO] [Inference] Starting Epoch 83 | Steps: 4
[11:26:31][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep83
[11:27:04][INFO] [S1] Epoch 084 | Avg Loss: 0.048862 | Best: 0.044191 | LR: 7.89e-06 | Time: 32.1s
[11:27:05][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch81.pt
[11:27:05][INFO] [Inference] Starting Epoch 84 | Steps: 4
[11:27:05][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep84
[11:27:37][INFO] [S1] Epoch 085 | Avg Loss: 0.045744 | Best: 0.044191 | LR: 7.12e-06 | Time: 32.1s
[11:27:38][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch82.pt
[11:27:38][INFO] [Inference] Starting Epoch 85 | Steps: 4
[11:27:39][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep85
[11:28:11][INFO] [S1] Epoch 086 | Avg Loss: 0.049426 | Best: 0.044191 | LR: 6.40e-06 | Time: 32.6s
[11:28:12][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch83.pt
[11:28:12][INFO] [Inference] Starting Epoch 86 | Steps: 4
[11:28:13][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep86
[11:28:45][INFO] [S1] Epoch 087 | Avg Loss: 0.053125 | Best: 0.044191 | LR: 5.71e-06 | Time: 32.5s
[11:28:46][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch84.pt
[11:28:46][INFO] [Inference] Starting Epoch 87 | Steps: 4
[11:28:47][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep87
[11:29:20][INFO] [S1] Epoch 088 | Avg Loss: 0.052962 | Best: 0.044191 | LR: 5.07e-06 | Time: 32.4s
[11:29:21][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch85.pt
[11:29:21][INFO] [Inference] Starting Epoch 88 | Steps: 4
[11:29:22][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep88
[11:29:54][INFO] [S1] Epoch 089 | Avg Loss: 0.047251 | Best: 0.044191 | LR: 4.48e-06 | Time: 32.6s
[11:29:55][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch86.pt
[11:29:55][INFO] [Inference] Starting Epoch 89 | Steps: 4
[11:29:56][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep89
[11:30:29][INFO] [S1] Epoch 090 | Avg Loss: 0.049049 | Best: 0.044191 | LR: 3.93e-06 | Time: 32.8s
[11:30:30][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch87.pt
[11:30:30][INFO] [Inference] Starting Epoch 90 | Steps: 4
[11:30:31][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep90
[11:31:04][INFO] [S1] Epoch 091 | Avg Loss: 0.046577 | Best: 0.044191 | LR: 3.42e-06 | Time: 32.9s
[11:31:05][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch88.pt
[11:31:05][INFO] [Inference] Starting Epoch 91 | Steps: 4
[11:31:06][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep91
[11:31:38][INFO] [S1] Epoch 092 | Avg Loss: 0.049918 | Best: 0.044191 | LR: 2.97e-06 | Time: 32.4s
[11:31:39][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch89.pt
[11:31:39][INFO] [Inference] Starting Epoch 92 | Steps: 4
[11:31:40][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep92
[11:32:13][INFO] [S1] Epoch 093 | Avg Loss: 0.041542 | Best: 0.041542 | LR: 2.56e-06 | Time: 33.2s
[11:32:14][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch90.pt
[11:32:14][INFO] [Inference] Starting Epoch 93 | Steps: 4
[11:32:15][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep93
[11:32:48][INFO] [S1] Epoch 094 | Avg Loss: 0.047856 | Best: 0.041542 | LR: 2.19e-06 | Time: 32.8s
[11:32:49][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch91.pt
[11:32:49][INFO] [Inference] Starting Epoch 94 | Steps: 4
[11:32:50][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep94
[11:33:23][INFO] [S1] Epoch 095 | Avg Loss: 0.046352 | Best: 0.041542 | LR: 1.88e-06 | Time: 33.3s
[11:33:24][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch92.pt
[11:33:24][INFO] [Inference] Starting Epoch 95 | Steps: 4
[11:33:25][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep95
[11:33:58][INFO] [S1] Epoch 096 | Avg Loss: 0.043263 | Best: 0.041542 | LR: 1.61e-06 | Time: 32.7s
[11:33:59][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch93.pt
[11:33:59][INFO] [Inference] Starting Epoch 96 | Steps: 4
[11:34:00][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep96
[11:34:32][INFO] [S1] Epoch 097 | Avg Loss: 0.047489 | Best: 0.041542 | LR: 1.39e-06 | Time: 32.6s
[11:34:33][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch94.pt
[11:34:33][INFO] [Inference] Starting Epoch 97 | Steps: 4
[11:34:34][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep97
[11:35:06][INFO] [S1] Epoch 098 | Avg Loss: 0.046380 | Best: 0.041542 | LR: 1.22e-06 | Time: 32.6s
[11:35:07][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch95.pt
[11:35:07][INFO] [Inference] Starting Epoch 98 | Steps: 4
[11:35:08][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep98
[11:35:41][INFO] [S1] Epoch 099 | Avg Loss: 0.047033 | Best: 0.041542 | LR: 1.10e-06 | Time: 32.6s
[11:35:42][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch96.pt
[11:35:42][INFO] [Inference] Starting Epoch 99 | Steps: 4
[11:35:43][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep99
[11:36:15][INFO] [S1] Epoch 100 | Avg Loss: 0.049880 | Best: 0.041542 | LR: 1.02e-06 | Time: 32.6s
[11:36:16][INFO] üóëÔ∏è  Removed old checkpoint: stage1_epoch97.pt
[11:36:16][INFO] [Inference] Starting Epoch 100 | Steps: 4
[11:36:17][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1/ep100
[11:36:17][INFO] [Stage 1] Training Completed. Saving final checkpoint...
üé® Running Final Inference...
[11:36:18][INFO] [Model] Compiling network with torch.compile (max-autotune)...
[11:36:19][INFO] [Inference] Starting Epoch final | Steps: 4
[11:36:19][INFO] [Inference] Error processing 00010.jpg: Error: accessing tensor output of CUDAGraphs that has been overwritten by a subsequent run. Stack trace: File "/mnt/g/GitHub/VAE_ca_proj/src/SAFlow.py", line 242, in forward
    v = self.final(x). To prevent overwriting, clone the tensor outside of torch.compile() or call torch.compiler.cudagraph_mark_step_begin() before each model invocation.
[11:36:20][INFO] [Inference] Successfully finished. Output: AutoSearch_Results/Exp1_Baseline/checkpoints/inf/stage1_final/epfinal
‚úÖ Experiment [Exp1_Baseline] Training Completed in 18.2 mins.

============================================================
üìä Running Evaluations for: Exp1_Baseline
üìÇ Results will be saved to: AutoSearch_Results/Exp1_Baseline/checkpoints/evaluation
============================================================

üîπ [1/3] Running LPIPS Evaluation...
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /home/xy/miniconda3/envs/cu128/lib/python3.12/site-packages/lpips/weights/v0.1/alex.pth
Total images found: 872

üõë User Interrupted. Exiting...
üßπ GPU Memory Cleared.
